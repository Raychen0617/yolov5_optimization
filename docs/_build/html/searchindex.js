Search.setIndex({"docnames": ["index", "kd/overview", "nas/multi-trial", "nas/oneshot", "nas/overview", "pruning/iterative_pruning", "pruning/overview", "pruning/prune", "tutorial"], "filenames": ["index.rst", "kd/overview.md", "nas/multi-trial.md", "nas/oneshot.md", "nas/overview.md", "pruning/iterative_pruning.md", "pruning/overview.md", "pruning/prune.md", "tutorial.md"], "titles": ["Yolov5 Optimization Doc", "Knowledge distillation (KD)", "Multi-trial Detection NAS With Efficiency Rewards", "One-Shot NAS on YOLOv5 backbone", "Neural Architecture Search (NAS)", "Iterative Pruning", "Pruning", "Prune Yolov5 backbone", "Tutorials"], "terms": {"index": [], "modul": [1, 8], "search": [0, 2], "page": [], "To": [1, 3, 4, 6, 8], "automat": [4, 8], "network": [1, 4, 8], "lead": [4, 8], "best": [4, 8], "accuraci": [1, 4, 8], "block": [2, 3, 4, 8], "residu": [4, 8], "incept": [4, 8], "bottleneck": [2, 3, 4, 8], "etc": [4, 6, 8], "layer": [2, 4, 5, 7, 8], "conv": [2, 3, 4, 5, 7, 8], "pool": [4, 8], "fc": [4, 8], "hyperparamet": [2, 4, 8], "number": [2, 3, 4, 8], "filter": [4, 8], "size": [2, 3, 4, 5, 7, 8], "kernel": [2, 3, 4, 8], "stride": [2, 3, 4, 5, 7, 8], "pad": [2, 3, 4, 7, 8], "The": [1, 3, 4, 5, 7, 8], "set": [2, 4, 5, 8], "contain": [4, 8], "all": [2, 4, 5, 7, 8], "possibl": [4, 8], "exampl": [1, 2, 4, 6, 8], "construct": [0, 4, 8], "more": [3, 4, 5, 6, 7, 8], "detail": [4, 6, 8], "pleas": [3, 4, 5, 6, 7, 8], "refer": [4, 5, 6, 7, 8], "nni": [0, 2, 3, 4, 5, 6, 7, 8], "import": [2, 3, 4, 6, 7, 8], "retiarii": [2, 3, 4, 8], "nn": [1, 2, 3, 4, 7, 8], "pytorch": [0, 2, 3, 4, 6, 8], "self": [1, 2, 3, 4, 8], "layerchoic": [2, 3, 4, 8], "op": [4, 8], "poolbn": [4, 8], "max": [2, 4, 5, 7, 8], "channel": [2, 3, 4, 8], "3": [2, 3, 4, 5, 7, 8], "1": [0, 1, 2, 3, 4, 5, 7, 8], "sepconv": [4, 8], "ident": [2, 3, 4, 8], "backbon": [0, 2, 4, 5, 6, 8], "yaml": [0, 5, 7, 8], "yolov5sb": [7, 8], "main": [1, 8], "py": [0, 1, 2, 3, 5, 7, 8], "common": 8, "class": [1, 2, 3, 8], "nasc3": [2, 7, 8], "l181": 8, "nasconv": [2, 7, 8], "l214": 8, "aim": [6, 8], "remov": [6, 8], "unimport": [6, 8], "while": [6, 8], "minim": [6, 8], "reconstruct": [6, 8], "error": [2, 3, 6, 8], "everi": [6, 8], "ex": [2, 6, 8], "l1": [5, 6, 7, 8], "l2": [5, 6, 7, 8], "apoz": [6, 8], "fpgm": [5, 6, 7, 8], "from": [1, 2, 3, 6, 7, 8], "compress": [5, 6, 7, 8], "l1normprun": [5, 6, 7, 8], "pruner": [5, 6, 7, 8], "config_list": [6, 8], "gener": [2, 5, 6, 7, 8], "mask": [5, 6, 7, 8], "_": [2, 3, 5, 6, 7, 8], "improv": [1, 8], "student": [0, 1, 8], "": [0, 1, 2, 3, 8], "help": [1, 8], "teacher": [0, 1, 8], "softtarget": [1, 8], "http": [1, 8], "arxiv": [1, 8], "org": [1, 8], "pdf": [1, 8], "1503": [1, 8], "02531": [1, 8], "onli": [0, 1, 2, 8], "chang": [1, 5, 7, 8], "origin": [1, 2, 3, 8], "train": [0, 1, 2, 5, 7, 8], "i": [1, 2, 3, 5, 7, 8], "implement": [1, 8], "new": [0, 1, 8], "loss": [1, 2, 8], "function": [1, 2, 3, 8], "def": [1, 2, 3, 8], "__init__": [1, 2, 3, 8], "t": [1, 8], "super": [1, 2, 3, 8], "forward": [1, 3, 8], "out_": [1, 8], "out_t": [1, 8], "f": [1, 2, 3, 8], "kl_div": [1, 8], "log_softmax": [1, 8], "dim": [1, 8], "softmax": [1, 8], "reduct": [1, 8], "batchmean": [1, 8], "return": [1, 3, 5, 7, 8], "integr": [1, 2, 8], "specifi": [1, 2, 8], "t_weight": [0, 1, 8], "execut": [1, 8], "convert_compar": 8, "convert": 8, "tflite": 8, "compar": 8, "differ": [2, 3, 8], "between": [2, 3, 8], "output": [2, 3, 8], "match": [5, 8], "structual": 8, "back": [0, 5, 8], "yolo": [5, 7, 8], "model_evalu": 8, "evalu": 8, "infer": 8, "time": [2, 8], "paramet": [2, 8], "flop": 8, "specif": [5, 7, 8], "calcul": 8, "environ": 8, "gpu": [2, 3, 8], "rtx": 8, "3090": 8, "10": [0, 2, 3, 7, 8], "python": [0, 8], "7": [2, 3, 8], "o": [2, 8], "ubuntu": 8, "20": [2, 8], "04": 8, "config": [2, 5, 8], "100": [2, 8], "epoch": [0, 2, 5, 8], "scratch": [2, 8], "dataset": [2, 8], "coco": [0, 2, 8], "neural": [0, 1], "architectur": 0, "prune": 0, "knowledg": 0, "distil": 0, "model": [0, 1, 5, 6, 7, 8], "na": 0, "kd": [], "tool": [], "experi": [], "result": 2, "indic": [], "tabl": [], "tutori": [], "welcom": [], "yolov5": [2, 4, 5, 6], "optim": [1, 2], "document": [], "intellig": [], "lightweight": [], "power": [], "toolkit": [], "user": [], "autom": [], "featur": [], "engin": [], "instal": [], "current": [], "releas": [], "pip": [], "see": [], "guid": [], "you": [2, 3], "need": [2, 3, 4], "addit": [], "nnictl": [], "hello": [], "have": [3, 5, 7], "well": [], "torchvis": [], "run": [2, 3, 4, 5], "thi": 0, "journei": [], "now": [], "follow": [2, 4, 5, 7], "absolut": [], "quickstart": [], "maintain": [], "github": [], "repositori": [], "we": [0, 3, 5, 7], "collect": [], "feedback": [], "propos": [], "idea": [], "can": [2, 3, 5, 7], "open": [2, 3], "issu": [], "bug": [], "request": [], "pull": [], "code": 4, "sure": [2, 3], "read": [], "befor": 2, "do": 2, "particip": [], "discuss": [], "question": [], "join": [], "im": [5, 7], "group": [2, 3], "gitter": [], "wechat": [], "If": [], "us": [2, 3, 5, 7], "scientif": [], "public": [], "consid": [], "microsoft": [], "version": [], "com": [], "bibtex": [], "entri": [], "replac": [2, 3, 5, 7], "particular": [], "ar": [2, 5, 7], "softwar": [], "nni2021": [], "author": [], "month": [], "titl": [], "url": [], "2": [0, 2, 3, 5, 7], "0": [2, 3, 5, 7], "year": [], "2021": [], "start": 2, "project": 0, "manag": 0, "sever": 0, "method": [0, 5, 7], "includ": 0, "algorithm": 1, "test": [0, 2, 3], "br": [], "tensorflow": 0, "fvcore": 0, "vision": 0, "toolbox": 0, "gau": [], "nernst": [], "9": [0, 2, 3, 7], "one": [0, 3], "shot": [0, 4], "bash": [], "oneshot_na": [0, 3], "data": [0, 2, 3, 5], "101": 0, "weight": [0, 2], "checkpoint": [0, 7], "enasv2_l1_yolov5": [], "pt": [0, 7], "yolov5m": [], "soft": 0, "target": [0, 2], "work": 0, "One": [0, 4], "instead": 3, "full": [], "map": [0, 2], "structur": 0, "detect": [0, 3, 5, 7], "multi": 0, "trial": [0, 3, 4], "hello_na": [0, 2], "convers": [], "For": [4, 5, 7], "ultralyt": [], "gpl": [], "licens": [], "nc": [2, 3, 7], "80": 2, "depth_multipl": [], "33": [], "depth": [], "multipl": [5, 7], "width_multipl": [], "50": [], "anchor": 2, "13": 7, "16": [2, 3], "30": [], "23": [], "p3": [2, 3], "8": [2, 3, 7], "61": [], "62": [], "45": [], "59": [], "119": [], "p4": [2, 3], "116": [], "90": [], "156": [], "198": [], "373": [], "326": [], "p5": [2, 3], "32": [2, 3, 5, 7], "v6": [2, 3], "arg": [2, 3], "64": [2, 3, 5, 7], "6": [2, 3, 7], "p1": [2, 3], "128": [2, 3], "p2": [2, 3], "4": [2, 3, 7], "256": [2, 3], "512": [2, 3], "5": [2, 3, 5], "1024": [2, 3], "sppf": [2, 3], "spp": 3, "head": 3, "upsampl": [], "none": [2, 3, 5, 7], "nearest": [], "concat": 7, "cat": [], "c3": [2, 3], "fals": [2, 3, 5, 7], "17": 7, "small": [], "14": 7, "medium": [], "larg": [], "changabl": [], "csp": [2, 3], "convolut": [2, 3], "c1": [2, 3], "c2": [2, 3], "inputshap": [2, 3], "id": [2, 3], "n": [2, 3], "shortcut": [2, 3], "true": [2, 3], "g": [2, 3, 5, 7], "e": [2, 3], "ch_in": [2, 3], "ch_out": [2, 3], "expans": [2, 3], "c_": [2, 3], "int": [2, 3], "hidden": [], "choic": [2, 3], "scale": [2, 3], "append": [2, 3], "nasc3sub": [2, 3], "total": [2, 3], "label": [2, 3], "c3_": [2, 3], "format": [2, 3], "cv1": [2, 3, 7], "cv2": [2, 3, 7], "cv3": [2, 3, 7], "option": [2, 3], "act": [2, 3, 7], "frelu": [2, 3], "m": [2, 3, 5, 7], "sequenti": [2, 3], "rang": [2, 3, 5], "variant": [2, 3], "adjust": [2, 3], "numnber": [2, 3], "varat": [2, 3], "choos": [2, 3], "activ": [2, 3, 5, 7], "standard": [2, 3], "k": [2, 3, 5, 7], "p": [2, 3], "conv2d": [2, 3, 5, 7], "autopad": [2, 3], "bia": [2, 3, 7], "outputshap": [2, 3], "conv_2d_output_shap": [2, 3], "offsetk": [2, 3], "offsetpad": [2, 3], "els": [2, 3, 5, 7], "nasconv_": [2, 3], "shape": [2, 3], "bn": [2, 3, 7], "batchnorm2d": [2, 3], "silu": [2, 3], "isinst": [2, 5, 7], "act_choic": [2, 3], "relu": [2, 3], "_act": [2, 3], "part": 2, "yolov5s_na": 2, "changeabl": [2, 3], "check": [2, 3, 5, 7], "make": [2, 3, 5, 7], "same": [2, 3], "devic": [2, 3, 5, 7], "cuda": 2, "hyp": 2, "low": 2, "cfg": [2, 3, 5, 7], "model_spac": [2, 3], "ch": [2, 3], "get": [2, 7], "support": [2, 5, 7], "mani": [2, 5, 7], "startegi": 2, "simpli": 2, "instanti": 2, "below": 2, "search_strategi": 2, "random": 2, "dedup": 2, "dedupl": 2, "want": 2, "evaluate_model": 2, "model_detect": 2, "torch": [2, 3, 5, 7], "is_avail": 2, "cpu": 2, "str": 2, "ignor": 2, "safe_load": 2, "world_siz": 2, "getenv": 2, "imgsz": [2, 5, 7], "640": [2, 5], "batch_siz": [2, 3], "single_cl": 2, "util": [2, 3], "colorstr": 2, "train_path": 2, "home": 2, "raytjchen": 2, "desktop": 2, "coco128": [2, 5], "imag": [2, 5, 7], "train2017": 2, "nb": 2, "nomin": 2, "batch": 2, "how": 2, "singl": 2, "accumul": 2, "round": 2, "weight_decai": 2, "torch_util": 2, "smart_optim": 2, "sgd": 2, "lr0": 2, "momentum": 2, "schedul": 2, "lf": 2, "lambda": 2, "x": [2, 3, 5, 7], "lrf": 2, "linear": [2, 3], "lr_schedul": 2, "lambdalr": 2, "lr_lambda": 2, "plot_lr_schedul": 2, "trainload": 2, "dataload": [2, 3], "create_dataload": 2, "train_load": [2, 3], "augment": 2, "cach": 2, "rect": 2, "rank": 2, "worker": 2, "image_weight": 2, "quad": 2, "prefix": 2, "shuffl": 2, "testload": 2, "val_path": 2, "val_load": 2, "val": 2, "attribut": 2, "obj": 2, "label_smooth": 2, "attach": 2, "labels_to_class_weight": 2, "class_weight": 2, "name": [2, 7], "nas_yolov5": 2, "len": [2, 5, 7], "nw": 2, "warmup_epoch": 2, "last_opt_step": 2, "numpi": 2, "np": 2, "zero": [2, 5, 7], "per": 2, "r": 2, "95": 2, "val_loss": 2, "box": 2, "cl": 2, "last_epoch": 2, "move": 2, "scaler": 2, "amp": 2, "gradscal": 2, "enabl": 2, "nascomputeloss": 2, "compute_loss": 2, "h": 2, "mloss": 2, "pbar": 2, "enumer": [2, 3], "tqdm": 2, "bar_format": 2, "l_bar": 2, "bar": 2, "r_bar": 2, "10b": 2, "zero_grad": 2, "batch_idx": 2, "img": 2, "path": 2, "ni": 2, "sinc": 2, "non_block": 2, "float": 2, "255": 2, "uint8": 2, "float32": 2, "pred": 2, "loss_item": 2, "backward": 2, "step": 2, "unscale_": 2, "unscal": 2, "gradient": 2, "clip_grad_norm_": 2, "max_norm": 2, "clip": 2, "updat": 2, "mean": [2, 5, 7], "print": [2, 3, 5, 7], "end": 2, "valid": 2, "data_dict": 2, "check_dataset": 2, "half": 2, "save_dir": 2, "plot": 2, "callback": 2, "report_intermediate_result": 2, "1000": 2, "report": 2, "final": [2, 3, 5, 7], "report_final_result": 2, "fmrom": 2, "functionalevalu": 2, "evaluate_odel": [], "after": [2, 5, 7], "abov": 2, "prepar": 2, "shown": 2, "retiariiexperi": [2, 3], "retiariiexeconfig": [2, 3], "exp": [2, 3], "exp_config": [2, 3], "local": [2, 3], "experiment_nam": [2, 3], "yolov5s_nas_search": 2, "configur": 2, "control": 2, "most": [2, 3], "max_trial_numb": [2, 3], "spawn": [2, 3], "trial_concurr": [2, 3], "two": [2, 3], "concurr": [2, 3], "rememb": 2, "use_active_gpu": [2, 3], "should": 2, "wish": 2, "occupi": 2, "possibli": 2, "gui": 2, "trial_gpu_numb": [2, 3], "training_servic": [2, 3], "8083": 2, "model_dict": [2, 3], "export_top_model": [2, 3], "formatt": [2, 3], "dict": [2, 3, 5], "hyper": 2, "save_json_path": [2, 3], "json": [2, 3], "w": [2, 3], "fp": [2, 3], "dump": [2, 3], "memo": [], "warn": 4, "almost": [2, 3], "add": [2, 3], "model_wrapp": [2, 3], "begin": [2, 3], "raychen0617": [], "yolov5_optim": [], "blob": [], "master": [], "argument": 3, "start_tim": 2, "model_tim": 2, "term": 2, "our": [2, 3, 5, 7], "decis": 2, "alpha": 2, "03": 2, "yolov5sb_na": 3, "nas_backbone_yaml": 3, "nasbackbon": 3, "200": [3, 7], "full_cod": 3, "parse_backbon": 3, "d": 3, "input_channel": 3, "gd": [], "gw": 3, "list": [], "component_map": 3, "save": [3, 5, 7], "pre_shap": 3, "savelist": [], "out": 3, "kei": 3, "eval": 5, "string": [], "j": [], "contextlib": [], "suppress": [], "nameerror": [], "n_": [], "gain": [], "ghostconv": 3, "ghostbottleneck": 3, "dwconv": 3, "mixconv2d": 3, "focu": 3, "crossconv": 3, "bottleneckcsp": 3, "c3tr": 3, "c3spp": 3, "c3ghost": 3, "convtranspose2d": 3, "dwconvtranspose2d": 3, "c3x": 3, "make_divis": 3, "insert": 3, "repeat": 3, "elif": [3, 5, 7], "sum": [], "contract": [], "expand": [5, 7], "m_": [], "avgpool": 3, "adaptiveavgpool2d": 3, "find": 3, "1280": 3, "768": 3, "load": [3, 5], "view": 3, "tinyimagenet": 3, "train_dataset": 3, "test_dataset": 3, "test_load": 3, "create_tinyimagenet": 3, "batchsiz": 3, "explor": 3, "space": 3, "firstli": 3, "an": 3, "provid": 3, "criterion": 3, "good": 3, "program": 3, "task": 3, "so": 3, "pl": 3, "lightn": 3, "here": 3, "trace": 3, "train_dataload": 3, "num_work": 3, "val_dataload": 3, "other": 3, "keyword": 3, "pass": 3, "pytorch_lightn": 3, "trainer": 3, "max_epoch": 3, "In": 3, "dart": 3, "ena": 3, "strategi": 3, "exploration_strategi": 3, "execution_engin": 3, "oneshot": 3, "port": 3, "8081": 3, "fixed_arch": 3, "match_na": 3, "save_model_path": 3, "yolo_yaml": 3, "pars": 3, "compon": 3, "export": [5, 7], "friendli": [5, 7], "named_modul": [5, 7], "assign": [5, 7], "inplac": [5, 7], "onnx_dynam": [5, 7], "setup": [5, 7], "grid": [5, 7], "check_img_s": [5, 7], "verifi": [5, 7], "img_siz": [5, 7], "320": [5, 7], "192": [5, 7], "bchw": [5, 7], "idetect": [5, 7], "cfg_list": [5, 7], "whose": [5, 7], "type": [5, 7], "sparsiti": [5, 7], "ratio": [5, 7], "each": [5, 7], "defin": [5, 7], "variabl": [5, 7], "sparsity_per_lay": [5, 7], "op_typ": [5, 7], "There": [5, 7], "inform": [5, 7], "l2normprun": [5, 7], "fpgmpruner": [5, 7], "show_pruned_weight": [5, 7], "_unwrap_model": [5, 7], "perform": [5, 7], "real": [5, 7], "speedup": [5, 7], "therefor": [5, 7], "smaller": [5, 7], "without": [5, 7], "m_speedup": [5, 7], "modelspeedup": [5, 7], "masks_fil": [5, 7], "speedup_model": [5, 7], "pruned_yolo": [5, 7], "opt": 5, "run_model": 5, "state": 5, "load_state_dict": [5, 7], "state_dict": 5, "strict": 5, "iterative_prun": 5, "iter": 6, "ori_backbone_model": 7, "referenc": 7, "vision_toolbox": 7, "which": 7, "imagenet": 7, "convert_weights_direct": 7, "pretrain_backbon": 7, "save_prun": 7, "test_pruned_yolov5sb": 7, "25": 7, "pruned_yolo_lay": 7, "model_typ": 7, "cannot": 7, "found": 7, "in_channel": 7, "out_channel": 7, "kernel_s": 7, "retun": 7, "cspnet": 7, "ori_model": 7, "save_matched_prun": 7}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"welcom": [], "yolov5": [0, 1, 3, 7, 8], "optim": [0, 8], "doc": 0, "": 6, "document": [], "indic": [], "tabl": [], "model": [2, 3], "neural": [4, 8], "architectur": [4, 8], "search": [4, 8], "na": [2, 3, 4, 8], "goal": [1, 4, 6, 8], "space": [2, 4, 8], "tutori": [0, 1, 4, 6, 8], "code": [1, 2, 3, 5, 7, 8], "br": [1, 8], "prune": [5, 6, 7, 8], "rank": [6, 8], "algorithm": [6, 8], "knowledg": [1, 8], "distil": [1, 8], "kd": [1, 8], "tool": 8, "experi": [2, 3, 8], "result": 8, "content": [], "get": 3, "start": 0, "try": [], "your": [], "first": [], "nni": [], "why": 6, "choos": [], "make": [], "automl": [], "techniqu": [], "plug": [], "plai": [], "eas": [], "effort": [], "scale": [], "manag": [], "support": 3, "contribut": [], "back": 3, "cite": [], "environ": 0, "setup": [0, 2, 3], "quick": 0, "api": 0, "overview": [], "common": 0, "issu": 0, "multi": [2, 4], "trial": 2, "detect": 2, "effici": 2, "reward": 2, "option": 4, "defin": [2, 3], "changabl": [2, 3], "modul": [2, 3], "chang": [2, 3], "yaml": [2, 3], "file": [2, 3], "our": [], "explor": 2, "pick": 2, "an": 2, "strategi": 2, "custom": 2, "evalu": [2, 3], "creat": [2, 7], "launch": [2, 3], "export": [2, 3], "best": [2, 3], "user": [2, 3], "The": 2, "A": 2, "full": [2, 3, 5, 7], "On": [2, 3, 5, 7], "github": [2, 3, 5, 7], "With": 2, "One": 3, "shot": 3, "backbon": [3, 7], "construct": 3, "componenet": 3, "nasc3": 3, "nasconv": 3, "function": [5, 7], "pars": [], "compon": [], "wrap": 3, "classif": 3, "train": 3, "dataset": 3, "startegi": 3, "set": [3, 7], "config": [3, 7], "final": [], "usabl": 3, "map": [3, 7], "structur": 3, "yolo": 3, "oneshot": 4, "v": 4, "trail": 4, "iter": 5, "prepar": [5, 7], "finetun": 5, "And": 6, "what": 6, "channel": 6, "load": 7, "pretrain": 7, "match": 7, "call": 7}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})